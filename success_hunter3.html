<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Success Hunter ‚Äî Level Up Your Day</title>
<style>
  :root{
    --bg:#0f1226;
    --card:#181c3a;
    --muted:#aab1ff;
    --text:#f5f7ff;
    --accent:#7c8cff;
    --accent2:#4ee7a6;
    --warn:#ffad49;
    --danger:#ff5d73;
    --shadow: 0 8px 20px rgba(0,0,0,.35);
    --radius:14px;
  }
  *{box-sizing:border-box}
  body{
    margin:0; padding:24px;
    font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji","Segoe UI Emoji";
    background: radial-gradient(1200px 700px at 20% -10%, #1b2050 0%, var(--bg) 50%) fixed, var(--bg);
    color: var(--text);
  }
  h1, h2, h3{margin: 0 0 12px 0}
  h1{font-size: clamp(22px, 3.8vw, 34px); letter-spacing:.3px}
  h2{font-size: clamp(18px, 3vw, 24px); color: var(--muted)}
  .wrap{max-width: 1200px; margin: 0 auto}
  .grid{display:grid; gap:16px}
  .g-2{grid-template-columns: repeat(2, minmax(0,1fr))}
  .card{
    background: linear-gradient(180deg, rgba(255,255,255,.03), transparent), var(--card);
    border:1px solid rgba(255,255,255,.08);
    border-radius: var(--radius);
    padding:16px;
    box-shadow: var(--shadow);
  }
  .row{display:flex; gap:12px; align-items:center; flex-wrap:wrap}
  .btn{
    cursor:pointer; border:none; border-radius: 12px; padding:10px 14px;
    background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(0,0,0,.05)), var(--accent);
    color: white; font-weight:600; box-shadow: var(--shadow); transition:.15s transform;
  }
  .btn:hover{transform: translateY(-1px)}
  .btn.secondary{ background: #2a2f60}
  .btn.good{ background: var(--accent2)}
  .btn.warn{ background: var(--warn); color:#1a140a}
  .btn.danger{ background: var(--danger)}
  input, select{
    width:100%; padding:10px 12px; border-radius: 10px; border:1px solid rgba(255,255,255,.12);
    background:#0f1334; color:var(--text);
  }
  label{font-size:12px; color:#c6cbff}
  .kpi{display:flex; gap:14px; flex-wrap:wrap}
  .kpi .tile{
    padding:14px 16px; border-radius:12px; background: #10143a; border:1px solid rgba(255,255,255,.08);
    min-width: 180px;
  }
  .kpi .big{font-size:24px; font-weight:800}
  .progress{
    height:14px; border-radius: 999px; background: rgba(255,255,255,.08); overflow:hidden; position:relative;
  }
  .progress > span{
    position:absolute; left:0; top:0; height:100%; background: linear-gradient(90deg, var(--accent2), var(--accent));
    width:0%;
  }
  table{width:100%; border-collapse: collapse}
  th, td{padding:10px; border-bottom:1px solid rgba(255,255,255,.08); text-align:left}
  th{color:#cfd3ff; font-weight:600; font-size:13px}
  tr:hover td{ background: rgba(255,255,255,.03)}
  .small{font-size:12px; color:#b9befe}
  .right{margin-left:auto}
  .muted{color:#c0c5ff}
  .notice{font-size:12px; color:#cbd1ff}
  .badge{font-weight:800; font-size:12px; background:#0b1034; padding:4px 8px; border-radius:8px; border:1px solid rgba(255,255,255,.1)}
  .spacer{height:8px}
  .footer{opacity:.75; font-size:12px; margin-top:12px}

  .chip{display:inline-flex; gap:6px; align-items:center; font-size:12px; padding:6px 10px; border:1px solid rgba(255,255,255,.14); border-radius:999px; background:#0f1334; margin:4px 6px 0 0}
  .chip button{border:none; background:transparent; color:#ff99aa; cursor:pointer; font-weight:800}

  .calendar{display:grid; grid-template-columns: repeat(7, 1fr); gap:6px}
  .cal-head{display:grid; grid-template-columns: repeat(7, 1fr); gap:6px; margin-bottom:6px}
  .day-name{font-size:12px; text-align:center; color:#cbd1ff}
  .cell{background:#10143a; border:1px solid rgba(255,255,255,.08); border-radius:10px; padding:8px; min-height:80px; position:relative; cursor:pointer}
  .cell .d{position:absolute; top:6px; right:8px; font-size:12px; color:#b9befe}
  .cell .xp{position:absolute; bottom:8px; left:8px; font-size:12px; color:#9afbd1; font-weight:700}
  .cell.today{outline:2px solid var(--accent2)}
  .cell.other{opacity:.5}
  .cal-nav .btn{padding:8px 10px}

  .overlay{position:fixed; inset:0; background:rgba(0,0,0,.6); display:none; align-items:center; justify-content:center; z-index:1000}
  .overlay.show{display:flex}
  .modal{background:#10143a; border:1px solid rgba(255,255,255,.1); border-radius:14px; padding:16px; width:min(700px, 92vw); max-height:80vh; overflow:auto; box-shadow: var(--shadow)}
  .modal h3{margin-bottom:6px}
  .closeX{margin-left:auto; background:#2a2f60}

  #fxCanvas{position:fixed; inset:0; pointer-events:none; display:none; z-index:1500}
  #fxCanvas.show{display:block}
  .gg{position:fixed; inset:0; display:none; align-items:center; justify-content:center; z-index:1501; pointer-events:none}
  .gg.show{display:flex}
  .gg .msg{font-size: clamp(20px, 4vw, 44px); font-weight:900; color:#fff; text-shadow:0 0 18px rgba(255,255,255,.6); text-align:center; padding:0 16px}
</style>
</head>
<body>
<canvas id="fxCanvas"></canvas>
<div class="gg"><div class="msg" id="ggMsg">Great job Elshad! Enjoy! üéâ</div></div>

<div class="wrap">
  <div class="grid g-2">
    <div>
      <h1 id="appTitle">Success Hunter <span class="small" id="tagline">‚Äî turn your day into levels, XP, and rewards</span></h1>
      <div class="kpi">
        <div class="tile">
          <div class="small" data-i18n="level">Level</div>
          <div class="big" id="level">1</div>
          <div class="small"><span data-i18n="nextLevel">Next level in</span> <span id="toNext">100</span> XP</div>
        </div>
        <div class="tile">
          <div class="small" data-i18n="totalXP">Total XP</div>
          <div class="big" id="totalXP">0</div>
          <div class="small">Coins <span class="badge" title="Earn coins from tasks and spend in the Reward Shop">ü™ô</span> <span id="coins">0</span></div>
        </div>
        <div class="tile">
          <div class="small" data-i18n="today">Today</div>
          <div class="big"><span id="todayXP">0</span> / <span id="dailyGoal">75</span> XP</div>
          <div class="progress"><span id="progressBar"></span></div>
          <div class="small"><span data-i18n="streak">Streak</span> <span id="streak">0</span> üî•</div>
        </div>
        <div class="tile">
          <div class="small" data-i18n="thisWeek">This Week</div>
          <div class="big" id="weekXP">0</div>
          <div class="small" data-i18n="monSun">Mon‚ÄìSun total</div>
        </div>
        <div class="tile">
          <div class="small" data-i18n="thisMonth">This Month</div>
          <div class="big" id="monthXP">0</div>
          <div class="small" data-i18n="calendarMonth">Calendar month total</div>
        </div>
      </div>
    </div>
    <div class="card">
      <h2 data-i18n="quickSettings">Quick Settings</h2>
      <div class="grid g-2">
        <div>
          <label data-i18n="playerName">Player name</label>
          <input id="playerName" placeholder="Your name">
        </div>
        <div>
          <label data-i18n="language">Language</label>
          <select id="langSelect">
            <option value="en">üá¨üáß English</option>
            <option value="fr">üá´üá∑ Fran√ßais</option>
            <option value="ru">üá∑üá∫ –†—É—Å—Å–∫–∏–π</option>
            <option value="az">üá¶üáø Az…ôrbaycan</option>
          </select>
        </div>
        <div>
          <label data-i18n="dailyTarget">Daily XP Target</label>
          <input id="goalInput" type="number" min="10" step="5" value="75">
        </div>
        <div>
          <label data-i18n="coinRate">Coins per XP (reward economy)</label>
          <input id="coinRate" type="number" min="0" step="0.1" value="0.2">
        </div>
      </div>
      <div class="spacer"></div>
      <div class="row">
        <button class="btn secondary" id="resetToday" data-i18n="resetToday">Reset Today</button>
        <button class="btn warn" id="newDay" data-i18n="newDay">‚è≠ New Day</button>
        <button class="btn danger" id="hardReset" data-i18n="hardReset">Hard Reset</button>
        <div class="right small notice" id="saveNote">Saves locally. <button class="btn secondary" id="exportBtn" data-i18n="export">Export</button> <label class="btn secondary" for="importFile" id="importLbl">Import</label><input id="importFile" type="file" accept="application/json" style="display:none"></div>
      </div>
    </div>
  </div>

  <div class="spacer"></div>

  <div class="grid g-2">
    <div class="card">
      <h2 data-i18n="quests">Quests</h2>
      <div class="small" id="questHelp">Add/edit/remove quests. Categories are customizable below.</div>
      <div class="spacer"></div>
      <table id="taskTable">
        <thead><tr><th data-i18n="quest">Quest</th><th data-i18n="category">Category</th><th>XP</th><th></th></tr></thead>
        <tbody id="taskBody"></tbody>
      </table>
      <div class="spacer"></div>
      <h3 data-i18n="addEditQuest">Add / Edit Quest</h3>
      <div class="grid g-2">
        <div>
          <label data-i18n="title">Title</label>
          <input id="tTitle" placeholder="e.g., Client Outreach: 10 emails">
        </div>
        <div>
          <label data-i18n="category">Category</label>
          <select id="tCat"></select>
        </div>
        <div>
          <label data-i18n="xpReward">XP Reward</label>
          <input id="tXP" type="number" min="1" value="10">
        </div>
        <div class="row" style="align-items:end">
          <button class="btn" id="addTask" data-i18n="saveQuest">Save Quest</button>
          <button class="btn secondary" id="clearForm" data-i18n="clear">Clear</button>
        </div>
      </div>
    </div>

    <div class="card">
      <h2 data-i18n="rewardShop">Reward Shop</h2>
      <div class="small" id="shopHelp">Spend coins you‚Äôve earned to unlock treats.</div>
      <div id="shopList"></div>
      <div class="spacer"></div>
      <h3 data-i18n="addReward">Add Reward</h3>
      <div class="grid g-2">
        <div>
          <label data-i18n="reward">Reward</label>
          <input id="rTitle" placeholder="e.g., 1 hour CS2">
        </div>
        <div>
          <label data-i18n="cost">Cost (coins)</label>
          <input id="rCost" type="number" min="1" value="50">
        </div>
      </div>
      <div class="spacer"></div>
      <button class="btn good" id="addRewardBtn" data-i18n="add">Add</button>
    </div>
  </div>

  <div class="spacer"></div>

  <div class="grid g-2">
    <div class="card">
      <h2 data-i18n="categories">Categories</h2>
      <div class="small" id="catHelp">Create your own categories. The first is the default.</div>
      <div id="catChips"></div>
      <div class="spacer"></div>
      <div class="row">
        <input id="catInput" placeholder="New category name">
        <button class="btn" id="addCat" data-i18n="addCategory">Add Category</button>
      </div>
    </div>

    <div class="card">
      <h2 data-i18n="historyCalendar">History & Calendar</h2>
      <div class="row cal-nav">
        <button class="btn secondary" id="prevMonth">‚óÄ <span data-i18n="prev">Prev</span></button>
        <div class="small" id="calLabel"></div>
        <button class="btn secondary" id="nextMonth"><span data-i18n="next">Next</span> ‚ñ∂</button>
      </div>
      <div class="cal-head">
        <div class="day-name" data-i18n="mon">Mon</div><div class="day-name" data-i18n="tue">Tue</div><div class="day-name" data-i18n="wed">Wed</div><div class="day-name" data-i18n="thu">Thu</div><div class="day-name" data-i18n="fri">Fri</div><div class="day-name" data-i18n="sat">Sat</div><div class="day-name" data-i18n="sun">Sun</div>
      </div>
      <div class="calendar" id="calendar"></div>
    </div>
  </div>

  <div class="spacer"></div>

  <div class="card">
    <h2 data-i18n="activityLog">Activity Log</h2>
    <div id="log" class="small"></div>
    <div class="footer" id="tipText">Tip: Start with a ‚Äúboss fight‚Äù ‚Äî finish the hardest quest first for momentum.</div>
  </div>
</div>

<div class="overlay" id="dayOverlay">
  <div class="modal">
    <div class="row">
      <h3 id="dayTitle">Day Details</h3>
      <button class="btn closeX" id="closeOverlay" data-i18n="close">Close</button>
    </div>
    <div class="small" id="daySummary"></div>
    <div class="spacer"></div>
    <table>
      <thead><tr><th data-i18n="time">Time</th><th data-i18n="quest">Quest</th><th data-i18n="category">Category</th><th>XP</th></tr></thead>
      <tbody id="dayBody"></tbody>
    </table>
  </div>
</div>

<script>
// ===== I18N =====
const I18N = {
  en: { tagline:"‚Äî turn your day into levels, XP, and rewards", level:"Level", nextLevel:"Next level in", totalXP:"Total XP", today:"Today", streak:"Streak", thisWeek:"This Week", monSun:"Mon‚ÄìSun total", thisMonth:"This Month", calendarMonth:"Calendar month total", quickSettings:"Quick Settings", playerName:"Player name", language:"Language", dailyTarget:"Daily XP Target", coinRate:"Coins per XP (reward economy)", resetToday:"Reset Today", newDay:"‚è≠ New Day", hardReset:"Hard Reset", export:"Export", import:"Import", quests:"Quests", quest:"Quest", category:"Category", addEditQuest:"Add / Edit Quest", title:"Title", xpReward:"XP Reward", saveQuest:"Save Quest", clear:"Clear", rewardShop:"Reward Shop", shopHelp:"Spend coins you‚Äôve earned to unlock treats.", addReward:"Add Reward", reward:"Reward", cost:"Cost (coins)", add:"Add", categories:"Categories", catHelp:"Create your own categories. The first is the default.", addCategory:"Add Category", historyCalendar:"History & Calendar", prev:"Prev", next:"Next", mon:"Mon", tue:"Tue", wed:"Wed", thu:"Thu", fri:"Fri", sat:"Sat", sun:"Sun", activityLog:"Activity Log", close:"Close", time:"Time", tip:"Tip: Start with a ‚Äúboss fight‚Äù ‚Äî finish the hardest quest first for momentum.", questHelp:"Add/edit/remove quests. Categories are customizable below.", greatJob:(n)=>`Great job ${n}! Enjoy! üéâ`, dailyGoalMsg:(n)=>`Fantastic job ${n}! You can do anything! ‚ú®` },
  fr: { tagline:"‚Äî transformez votre journ√©e en niveaux, XP et r√©compenses", level:"Niveau", nextLevel:"Prochain niveau dans", totalXP:"XP total", today:"Aujourd'hui", streak:"S√©rie", thisWeek:"Cette semaine", monSun:"Total lun‚Äìdim", thisMonth:"Ce mois-ci", calendarMonth:"Total du mois", quickSettings:"R√©glages rapides", playerName:"Nom du joueur", language:"Langue", dailyTarget:"Objectif XP quotidien", coinRate:"Pi√®ces par XP (√©conomie des r√©compenses)", resetToday:"R√©initialiser aujourd'hui", newDay:"‚è≠ Nouveau jour", hardReset:"R√©initialisation totale", export:"Exporter", import:"Importer", quests:"Qu√™tes", quest:"Qu√™te", category:"Cat√©gorie", addEditQuest:"Ajouter / Modifier une qu√™te", title:"Titre", xpReward:"R√©compense XP", saveQuest:"Enregistrer la qu√™te", clear:"Effacer", rewardShop:"Boutique de r√©compenses", shopHelp:"D√©pensez des pi√®ces gagn√©es pour d√©bloquer des r√©compenses.", addReward:"Ajouter une r√©compense", reward:"R√©compense", cost:"Co√ªt (pi√®ces)", add:"Ajouter", categories:"Cat√©gories", catHelp:"Cr√©ez vos cat√©gories. La premi√®re est par d√©faut.", addCategory:"Ajouter une cat√©gorie", historyCalendar:"Historique & Calendrier", prev:"Pr√©c.", next:"Suiv.", mon:"Lun", tue:"Mar", wed:"Mer", thu:"Jeu", fri:"Ven", sat:"Sam", sun:"Dim", activityLog:"Journal d'activit√©", close:"Fermer", time:"Heure", tip:"Astuce : commencez par un ¬´ boss ¬ª ‚Äî terminez la t√¢che la plus difficile pour lancer l'√©lan.", questHelp:"Ajoutez/modifiez/supprimez des qu√™tes. Cat√©gories personnalisables ci-dessous.", greatJob:(n)=>`Bravo ${n} ! Profite ! üéâ`, dailyGoalMsg:(n)=>`Fantastique ${n} ! Tu peux tout faire ! ‚ú®` },
  ru: { tagline:"‚Äî –ø—Ä–µ–≤—Ä–∞—Ç–∏ —Å–≤–æ–π –¥–µ–Ω—å –≤ —É—Ä–æ–≤–Ω–∏, XP –∏ –Ω–∞–≥—Ä–∞–¥—ã", level:"–£—Ä–æ–≤–µ–Ω—å", nextLevel:"–°–ª–µ–¥—É—é—â–∏–π —É—Ä–æ–≤–µ–Ω—å —á–µ—Ä–µ–∑", totalXP:"–í—Å–µ–≥–æ XP", today:"–°–µ–≥–æ–¥–Ω—è", streak:"–°–µ—Ä–∏—è", thisWeek:"–≠—Ç–∞ –Ω–µ–¥–µ–ª—è", monSun:"–ò—Ç–æ–≥–æ –ø–Ω‚Äì–≤—Å", thisMonth:"–≠—Ç–æ—Ç –º–µ—Å—è—Ü", calendarMonth:"–ò—Ç–æ–≥–æ –∑–∞ –º–µ—Å—è—Ü", quickSettings:"–ë—ã—Å—Ç—Ä—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏", playerName:"–ò–º—è –∏–≥—Ä–æ–∫–∞", language:"–Ø–∑—ã–∫", dailyTarget:"–î–Ω–µ–≤–Ω–∞—è —Ü–µ–ª—å XP", coinRate:"–ú–æ–Ω–µ—Ç –∑–∞ XP (—ç–∫–æ–Ω–æ–º–∏–∫–∞ –Ω–∞–≥—Ä–∞–¥)", resetToday:"–°–±—Ä–æ—Å–∏—Ç—å —Å–µ–≥–æ–¥–Ω—è", newDay:"‚è≠ –ù–æ–≤—ã–π –¥–µ–Ω—å", hardReset:"–ü–æ–ª–Ω—ã–π —Å–±—Ä–æ—Å", export:"–≠–∫—Å–ø–æ—Ä—Ç", import:"–ò–º–ø–æ—Ä—Ç", quests:"–ó–∞–¥–∞–Ω–∏—è", quest:"–ó–∞–¥–∞–Ω–∏–µ", category:"–ö–∞—Ç–µ–≥–æ—Ä–∏—è", addEditQuest:"–î–æ–±–∞–≤–∏—Ç—å / –ò–∑–º–µ–Ω–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ", title:"–ù–∞–∑–≤–∞–Ω–∏–µ", xpReward:"–ù–∞–≥—Ä–∞–¥–∞ XP", saveQuest:"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ", clear:"–û—á–∏—Å—Ç–∏—Ç—å", rewardShop:"–ú–∞–≥–∞–∑–∏–Ω –Ω–∞–≥—Ä–∞–¥", shopHelp:"–¢—Ä–∞—Ç—å—Ç–µ –º–æ–Ω–µ—Ç—ã, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∞—Ç—å –Ω–∞–≥—Ä–∞–¥—ã.", addReward:"–î–æ–±–∞–≤–∏—Ç—å –Ω–∞–≥—Ä–∞–¥—É", reward:"–ù–∞–≥—Ä–∞–¥–∞", cost:"–°—Ç–æ–∏–º–æ—Å—Ç—å (–º–æ–Ω–µ—Ç)", add:"–î–æ–±–∞–≤–∏—Ç—å", categories:"–ö–∞—Ç–µ–≥–æ—Ä–∏–∏", catHelp:"–°–æ–∑–¥–∞–≤–∞–π—Ç–µ —Å–≤–æ–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏. –ü–µ—Ä–≤–∞—è ‚Äî –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.", addCategory:"–î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é", historyCalendar:"–ò—Å—Ç–æ—Ä–∏—è –∏ –∫–∞–ª–µ–Ω–¥–∞—Ä—å", prev:"–ù–∞–∑–∞–¥", next:"–í–ø–µ—Ä—ë–¥", mon:"–ü–Ω", tue:"–í—Ç", wed:"–°—Ä", thu:"–ß—Ç", fri:"–ü—Ç", sat:"–°–±", sun:"–í—Å", activityLog:"–ñ—É—Ä–Ω–∞–ª –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏", close:"–ó–∞–∫—Ä—ã—Ç—å", time:"–í—Ä–µ–º—è", tip:"–°–æ–≤–µ—Ç: –Ω–∞—á–Ω–∏ —Å ¬´–±–æ—Å—Å–∞¬ª ‚Äî —Å–¥–µ–ª–∞–π —Å–∞–º–æ–µ —Å–ª–æ–∂–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ, —á—Ç–æ–±—ã —Ä–∞–∑–æ–≥–Ω–∞—Ç—å—Å—è.", questHelp:"–î–æ–±–∞–≤–ª—è–π/—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π/—É–¥–∞–ª—è–π –∑–∞–¥–∞–Ω–∏—è. –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –Ω–∏–∂–µ.", greatJob:(n)=>`–û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞, ${n}! –ù–∞—Å–ª–∞–∂–¥–∞–π—Å—è! üéâ`, dailyGoalMsg:(n)=>`–§–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞, ${n}! –¢–µ–±–µ –≤—Å—ë –ø–æ —Å–∏–ª–∞–º! ‚ú®` },
  az: { tagline:"‚Äî g√ºn√ºn√º s…ôviyy…ôl…ôr…ô, XP-y…ô v…ô m√ºkafatlara √ßevir", level:"S…ôviyy…ô", nextLevel:"N√∂vb…ôti s…ôviyy…ôy…ô", totalXP:"C…ômi XP", today:"Bu g√ºn", streak:"Ardƒ±cƒ±l g√ºn", thisWeek:"Bu h…ôft…ô", monSun:"B.e‚ÄìB total", thisMonth:"Bu ay", calendarMonth:"Ay √ºzr…ô c…ôm", quickSettings:"S√ºr…ôtli t…ônziml…ôm…ôl…ôr", playerName:"Oyun√ßunun adƒ±", language:"Dil", dailyTarget:"G√ºnd…ôlik XP h…ôd…ôfi", coinRate:"XP √º√ß√ºn sikk…ô (m√ºkafat iqtisadiyyatƒ±)", resetToday:"Bu g√ºn√º sƒ±fƒ±rla", newDay:"‚è≠ Yeni g√ºn", hardReset:"Tam sƒ±fƒ±rlama", export:"Eksport", import:"Import", quests:"Tap≈üƒ±rƒ±qlar", quest:"Tap≈üƒ±rƒ±q", category:"Kateqoriya", addEditQuest:"Tap≈üƒ±rƒ±q …ôlav…ô/rediakt…ô et", title:"Ba≈ülƒ±q", xpReward:"XP m√ºkafatƒ±", saveQuest:"Tap≈üƒ±rƒ±ƒüƒ± saxla", clear:"T…ômizl…ô", rewardShop:"M√ºkafat maƒüazasƒ±", shopHelp:"Qazandƒ±ƒüƒ±n sikk…ôl…ôri m√ºkafata x…ôrcl…ô.", addReward:"M√ºkafat …ôlav…ô et", reward:"M√ºkafat", cost:"D…ôy…ôr (sikk…ô)", add:"∆èlav…ô et", categories:"Kateqoriyalar", catHelp:"√ñz kateqoriyalarƒ±nƒ± yarat. Birincisi standartdƒ±r.", addCategory:"Kateqoriya …ôlav…ô et", historyCalendar:"Tarix√ß…ô v…ô T…ôqvim", prev:"∆èvv…ôlki", next:"N√∂vb…ôti", mon:"B.e", tue:"√á.a", wed:"√á", thu:"C.a", fri:"C", sat:"≈û", sun:"B", activityLog:"F…ôaliyy…ôt jurnalƒ±", close:"Baƒüla", time:"Saat", tip:"M…ôsl…ôh…ôt: ‚Äúbosstan‚Äù ba≈üla ‚Äî …ôn √ß…ôtin tap≈üƒ±rƒ±ƒüƒ± …ôvv…ôl et ki, g√ºc yƒ±ƒüasan.", questHelp:"Tap≈üƒ±rƒ±qlarƒ± …ôlav…ô et/d…ôyi≈ü/sil. Kateqoriyalar a≈üaƒüƒ±da.", greatJob:(n)=>`∆èla i≈ü, ${n}! Z√∂vq al! üéâ`, dailyGoalMsg:(n)=>`M√∂ht…ô≈ü…ôms…ôn, ${n}! H…ôr ≈üeyi bacararsan! ‚ú®` }
};

// ===== Utilities =====
const $ = sel => document.querySelector(sel);
const el = (tag, cls) => { const e=document.createElement(tag); if(cls) e.className=cls; return e; };
const todayStr = () => new Date().toISOString().slice(0,10);
const parseDate = s => new Date(s+"T00:00:00");
const formatDate = d => d.toISOString().slice(0,10);
const pad = n => (n<10? "0"+n : ""+n);
function escapeHtml(str){ return (str+"").replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m])); }

// ===== State =====
const DEFAULT_STATE = {
  playerName: "Elshad",
  lang: "en",
  totalXP: 0,
  coins: 0,
  dailyGoal: 75,
  coinRate: 0.2,
  today: { date: todayStr(), xp: 0 },
  streak: 0,
  dailyHistory: [],
  dayLog: {},
  categories: ["Business","Health","French","Investing","Other"],
  tasks: [
    {id: crypto.randomUUID(), title:"Business: Client outreach (10 contacts)", cat:"Business", xp:15},
    {id: crypto.randomUUID(), title:"Business: Deep Work 60m (no phone)", cat:"Business", xp:20},
    {id: crypto.randomUUID(), title:"French: 20-minute practice", cat:"French", xp:12},
    {id: crypto.randomUUID(), title:"Health: 30-minute workout", cat:"Health", xp:15},
    {id: crypto.randomUUID(), title:"Investing: 15-minute research & journal", cat:"Investing", xp:10},
    {id: crypto.randomUUID(), title:"Health: Meal prep or healthy dinner", cat:"Health", xp:10},
  ],
  rewards: [
    {id: crypto.randomUUID(), title:"Fancy coffee / dessert", cost:30},
    {id: crypto.randomUUID(), title:"1 hour CS2", cost:60},
    {id: crypto.randomUUID(), title:"Movie night or new book", cost:120},
    {id: crypto.randomUUID(), title:"Treat yourself: small gadget", cost:240}
  ],
  log: [],
  calYear: new Date().getFullYear(),
  calMonth: new Date().getMonth()
};

let state = load();
function load(){
  const raw = localStorage.getItem("success_hunter_v2");
  if (raw){
    const s = JSON.parse(raw);
    s.playerName = s.playerName || "Elshad";
    s.lang = s.lang || "en";
    s.dayLog = s.dayLog || {};
    s.categories = s.categories || ["Business","Health","French","Investing","Other"];
    s.calYear = s.calYear ?? new Date().getFullYear();
    s.calMonth = s.calMonth ?? new Date().getMonth();
    applyDayRollover(s);
    save(s);
    return s;
  } else {
    save(DEFAULT_STATE);
    return JSON.parse(localStorage.getItem("success_hunter_v2"));
  }
}
function save(s=state){ localStorage.setItem("success_hunter_v2", JSON.stringify(s)); }

// ===== Leveling =====
function xpToLevel(total){
  let lvl = 1, need = 100, rem = total;
  while(rem >= need){ rem -= need; lvl += 1; need += 50; }
  return { level: lvl, intoLevel: rem, toNext: need - rem };
}

// ===== Day/Streak/History =====
function pushHistory(s, date, xp){
  if (!date) return;
  const idx = s.dailyHistory.findIndex(r => r.date === date);
  if (idx>=0) s.dailyHistory[idx].xp = xp;
  else s.dailyHistory.push({date, xp});
  s.dailyHistory = s.dailyHistory.sort((a,b)=> a.date.localeCompare(b.date)).slice(-365);
}
function applyDayRollover(s){
  const last = s.today?.date || todayStr();
  const today = todayStr();
  if (last === today) return;
  pushHistory(s, last, s.today.xp);
  const lastDate = new Date(last);
  const prev = new Date(today); prev.setDate(prev.getDate()-1);
  const wasYesterday = lastDate.toISOString().slice(0,10) === prev.toISOString().slice(0,10);
  if (wasYesterday){
    s.streak = (s.today.xp >= s.dailyGoal) ? (s.streak||0)+1 : 0;
  } else {
    s.streak = (s.today.xp >= s.dailyGoal) ? 1 : 0;
  }
  s.today = { date: today, xp: 0 };
}
function logMsg(s, msg){ const stamp = new Date().toLocaleString(); s.log.push(`[${stamp}] ${msg}`); if (s.log.length>400) s.log.shift(); }

// ===== Stats =====
function sumWeek(){
  const d = new Date();
  const day = (d.getDay()+6)%7;
  const monday = new Date(d); monday.setDate(d.getDate()-day);
  const sunday = new Date(monday); sunday.setDate(monday.getDate()+6);
  const inRange = r => {
    const rd = new Date(r.date+"T00:00:00");
    return rd >= new Date(monday.toISOString().slice(0,10)+"T00:00:00") && rd <= new Date(sunday.toISOString().slice(0,10)+"T00:00:00");
  };
  const histSum = state.dailyHistory.filter(inRange).reduce((a,b)=>a+b.xp,0);
  return histSum + state.today.xp;
}
function sumMonth(){
  const d = new Date();
  const start = new Date(d.getFullYear(), d.getMonth(), 1);
  const end = new Date(d.getFullYear(), d.getMonth()+1, 0);
  const inRange = r => {
    const rd = new Date(r.date+"T00:00:00");
    return rd >= start && rd <= end;
  };
  const histSum = state.dailyHistory.filter(inRange).reduce((a,b)=>a+b.xp,0);
  return histSum + state.today.xp;
}

// ===== UI =====
function applyI18N(){
  const L = I18N[state.lang];
  $("#tagline").textContent = L.tagline;
  document.querySelectorAll("[data-i18n]").forEach(n=>{
    const key = n.getAttribute("data-i18n");
    if (L[key]) n.textContent = L[key];
  });
  $("#saveNote").firstChild && ($("#saveNote").firstChild.textContent = (state.lang==='en'?'Saves locally. ': state.lang==='fr'?'Enregistr√© localement. ': state.lang==='ru'?'–°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ. ': 'Yerli yadda saxlanƒ±lƒ±r. '));
  $("#questHelp").textContent = L.questHelp;
  $("#shopHelp").textContent = L.shopHelp;
  $("#catHelp").textContent = L.catHelp;
  $("#tipText").textContent = L.tip;
  const days = ["mon","tue","wed","thu","fri","sat","sun"];
  document.querySelectorAll(".day-name").forEach((n,i)=> n.textContent = L[days[i]]);
}
function renderAll(){
  applyI18N();
  $("#playerName").value = state.playerName;
  $("#langSelect").value = state.lang;

  const lvl = xpToLevel(state.totalXP);
  $("#level").textContent = lvl.level;
  $("#toNext").textContent = lvl.toNext;
  $("#totalXP").textContent = state.totalXP;
  $("#coins").textContent = Math.round(state.coins);
  $("#todayXP").textContent = state.today.xp;
  $("#dailyGoal").textContent = state.dailyGoal;
  $("#streak").textContent = state.streak;
  $("#progressBar").style.width = Math.min(100, (state.today.xp/state.dailyGoal)*100) + "%";

  $("#weekXP").textContent = sumWeek();
  $("#monthXP").textContent = sumMonth();

  $("#goalInput").value = state.dailyGoal;
  $("#coinRate").value = state.coinRate;

  renderCategories();
  renderTasks();
  renderRewards();
  renderCalendar();

  const logDiv = $("#log");
  logDiv.innerHTML = state.log.slice().reverse().map(x => `<div>${escapeHtml(x)}</div>`).join("");
}
function renderCategories(){
  const sel = $("#tCat");
  sel.innerHTML = "";
  state.categories.forEach((c)=>{
    const opt = document.createElement("option");
    opt.value = c; opt.textContent = c;
    sel.appendChild(opt);
  });
  const chips = $("#catChips");
  chips.innerHTML = "";
  state.categories.forEach((c,i)=>{
    const chip = el("span","chip");
    chip.innerHTML = `<span>${escapeHtml(c)}</span>`;
    const del = document.createElement("button");
    del.textContent = "√ó";
    del.title = "Remove category";
    del.onclick = ()=>{
      if (!confirm(`Delete category "${c}"?`)) return;
      if (state.tasks.some(t=>t.cat===c)){ alert("This category is used by tasks. Change or delete those tasks first."); return; }
      state.categories.splice(i,1);
      if (!state.categories.length) state.categories.push("General");
      save(); renderAll();
    };
    if (state.categories.length>1) chip.appendChild(del);
    chips.appendChild(chip);
  });
  if (state.categories.length && sel && !$("#addTask").dataset.editing) sel.value = state.categories[0];
}
function renderTasks(){
  const body = $("#taskBody");
  body.innerHTML = "";
  state.tasks.forEach(t => {
    const tr = el("tr");
    tr.appendChild(td(t.title));
    tr.appendChild(td(t.cat));
    tr.appendChild(td(t.xp+" XP"));
    const action = el("td");
    const b1 = button((state.lang==="fr"?"Terminer +":"Complete +")+t.xp+" XP", "btn good", () => completeTask(t));
    const b2 = button(getText("edit","Edit"), "btn secondary", () => loadTaskToForm(t));
    const b3 = button("‚úï", "btn danger", () => deleteTask(t.id));
    action.append(b1, spacer(), b2, spacer(), b3);
    tr.appendChild(action);
    body.appendChild(tr);
  });
}
function renderRewards(){
  const shop = $("#shopList");
  shop.innerHTML = "";
  state.rewards.forEach(r => {
    const row = el("div","row");
    const left = el("div");
    left.className="row";
    const title = el("div"); title.innerHTML = `<strong>${escapeHtml(r.title)}</strong> <span class="muted">‚Äî ${r.cost} ü™ô</span>`;
    left.appendChild(title);
    const buy = button(getText("redeem","Redeem"), "btn", () => redeem(r));
    const del = button("‚úï", "btn danger", () => deleteReward(r.id));
    del.title = getText("remove","Remove");
    row.append(left, buy, del);
    shop.appendChild(row);
  });
}
function renderCalendar(){
  const label = $("#calLabel");
  label.textContent = `${state.calYear}-${pad(state.calMonth+1)}`;
  const cal = $("#calendar");
  cal.innerHTML = "";
  const first = new Date(state.calYear, state.calMonth, 1);
  const startDay = (first.getDay()+6)%7;
  const daysInMonth = new Date(state.calYear, state.calMonth+1, 0).getDate();
  for(let i=0;i<startDay;i++){ cal.appendChild(el("div","cell other")); }
  for(let d=1; d<=daysInMonth; d++){
    const c = el("div","cell");
    const thisDate = `${state.calYear}-${pad(state.calMonth+1)}-${pad(d)}`;
    if (thisDate === state.today.date) c.classList.add("today");
    const xp = (thisDate===state.today.date ? state.today.xp : (state.dailyHistory.find(r=>r.date===thisDate)?.xp || 0));
    const dn = el("div","d"); dn.textContent = d; c.appendChild(dn);
    const xv = el("div","xp"); xv.textContent = xp ? (xp+" XP") : ""; c.appendChild(xv);
    c.onclick = () => openDayDetails(thisDate, xp);
    cal.appendChild(c);
  }
  $("#prevMonth").onclick = ()=>{ let m = state.calMonth - 1, y = state.calYear; if (m<0){ m=11; y--; } state.calMonth = m; state.calYear = y; save(); renderCalendar(); };
  $("#nextMonth").onclick = ()=>{ let m = state.calMonth + 1, y = state.calYear; if (m>11){ m=0; y++; } state.calMonth = m; state.calYear = y; save(); renderCalendar(); };
}
function td(txt){ const d=el("td"); d.textContent=txt; return d;}
function spacer(){ const s=el("span"); s.style.width="6px"; return s; }
function button(label, cls, onClick){ const b=el("button", cls+" btn"); b.textContent=label; b.onclick=onClick; return b; }
function getText(key, fallback){
  const map = { edit:{en:"Edit",fr:"Modifier",ru:"–ò–∑–º–µ–Ω–∏—Ç—å",az:"D…ôyi≈ü"}, redeem:{en:"Redeem",fr:"Utiliser",ru:"–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å",az:"ƒ∞stifad…ô et"}, remove:{en:"Remove",fr:"Supprimer",ru:"–£–¥–∞–ª–∏—Ç—å",az:"Sil"} };
  return (map[key] && map[key][state.lang]) || fallback;
}

// ===== Actions =====
function completeTask(t){
  const pre = state.today.xp;
  const xp = Number(t.xp)||0;
  const coinsEarned = xp * (Number(state.coinRate)||0);
  state.totalXP += xp;
  state.today.xp += xp;
  state.coins += coinsEarned;
  const now = new Date();
  const time = now.toTimeString().slice(0,5);
  if (!state.dayLog[state.today.date]) state.dayLog[state.today.date] = [];
  state.dayLog[state.today.date].push({time, title:t.title, cat:t.cat, xp});
  logMsg(state, `‚úÖ Quest complete: "${t.title}" (+${xp} XP, +${Math.round(coinsEarned)} ü™ô)`);
  save(); renderAll();
  if (pre < state.dailyGoal && state.today.xp >= state.dailyGoal){
    const msg = I18N[state.lang].dailyGoalMsg(state.playerName || "Player");
    celebrate(msg);
  }
}
function loadTaskToForm(t){ $("#tTitle").value = t.title; $("#tCat").value = t.cat; $("#tXP").value = t.xp; $("#addTask").dataset.editing = t.id; }
function deleteTask(id){ state.tasks = state.tasks.filter(x=>x.id!==id); logMsg(state, `üóë Deleted quest.`); save(); renderAll(); }
function upsertTask(){
  const title = $("#tTitle").value.trim();
  const cat = $("#tCat").value;
  const xp = Math.max(1, Number($("#tXP").value||0));
  if(!title){ alert("Please enter a quest title"); return; }
  const editingId = $("#addTask").dataset.editing;
  if (editingId){
    const i = state.tasks.findIndex(x=>x.id===editingId);
    if (i>=0){ state.tasks[i].title=title; state.tasks[i].cat=cat; state.tasks[i].xp=xp; logMsg(state, "‚úèÔ∏è Updated quest."); }
    $("#addTask").dataset.editing="";
  } else {
    state.tasks.push({id: crypto.randomUUID(), title, cat, xp});
    logMsg(state, `‚ûï Added quest "${title}" (${xp} XP).`);
  }
  $("#tTitle").value=""; $("#tXP").value=10; $("#tCat").value=state.categories[0];
  save(); renderAll();
}
function clearForm(){ $("#tTitle").value=""; $("#tXP").value=10; $("#tCat").value=state.categories[0]; $("#addTask").dataset.editing=""; }
function addReward(){
  const title = $("#rTitle").value.trim();
  const cost = Math.max(1, Number($("#rCost").value||0));
  if (!title){ alert("Please enter a reward title"); return;}
  state.rewards.push({id: crypto.randomUUID(), title, cost});
  logMsg(state, `üéÅ Added reward "${title}" (${cost} ü™ô).`);
  $("#rTitle").value=""; $("#rCost").value=50;
  save(); renderAll();
}
function deleteReward(id){ state.rewards = state.rewards.filter(x=>x.id!==id); logMsg(state, "üóë Removed reward."); save(); renderAll(); }
function redeem(r){
  if (state.coins < r.cost){ alert("Not enough coins yet."); return; }
  if (!confirm(`Redeem "${r.title}" for ${r.cost} coins?`)) return;
  state.coins -= r.cost;
  logMsg(state, `üèÖ Redeemed: ${r.title} (‚àí${r.cost} ü™ô)`);
  const msg = I18N[state.lang].greatJob(state.playerName || "Player");
  celebrate(msg);
  save(); renderAll();
}

// Name / Lang
$("#playerName").addEventListener("input", e => { state.playerName = e.target.value || "Player"; save(); });
$("#langSelect").addEventListener("change", e => { state.lang = e.target.value || "en"; save(); renderAll(); });

// Settings
$("#goalInput").addEventListener("change", e => { state.dailyGoal = Math.max(10, Number(e.target.value||0)); logMsg(state, `üéØ Daily goal set to ${state.dailyGoal} XP.`); save(); renderAll(); });
$("#coinRate").addEventListener("change", e => { state.coinRate = Math.max(0, Number(e.target.value||0)); logMsg(state, `ü™ô Coin rate set to ${state.coinRate} per XP.`); save(); renderAll(); });

// Buttons
$("#resetToday").onclick = () => { if (!confirm("Reset today's XP?")) return; state.today.xp = 0; state.dayLog[state.today.date]=[]; logMsg(state, "‚ôªÔ∏è Reset today's XP."); save(); renderAll(); };
$("#newDay").onclick = () => { pushHistory(state, state.today.date, state.today.xp); state.streak = (state.today.xp >= state.dailyGoal) ? state.streak+1 : 0; state.today = { date: todayStr(), xp: 0 }; save(); renderAll(); };
$("#hardReset").onclick = () => { if (!confirm("Hard reset everything? This clears all data.")) return; localStorage.removeItem("success_hunter_v2"); state = JSON.parse(JSON.stringify(DEFAULT_STATE)); save(); renderAll(); };

$("#addTask").onclick = upsertTask;
$("#clearForm").onclick = clearForm;
$("#addRewardBtn").onclick = addReward;

// Day details overlay
$("#closeOverlay").onclick = ()=> $("#dayOverlay").classList.remove("show");
function openDayDetails(date, xp){
  $("#dayTitle").textContent = `${date}`;
  const list = state.dayLog[date] || [];
  $("#daySummary").textContent = `XP: ${xp} ‚Ä¢ Entries: ${list.length}`;
  const tb = $("#dayBody"); tb.innerHTML="";
  list.slice().sort((a,b)=> a.time.localeCompare(b.time)).forEach(e=>{
    const tr = document.createElement("tr");
    tr.innerHTML = `<td>${e.time}</td><td>${escapeHtml(e.title)}</td><td>${escapeHtml(e.cat)}</td><td>${e.xp}</td>`;
    tb.appendChild(tr);
  });
  $("#dayOverlay").classList.add("show");
}

// Export / Import
$("#exportBtn").onclick = () => {
  const data = JSON.stringify(state, null, 2);
  const blob = new Blob([data], {type:"application/json"});
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url;
  a.download = "success_hunter_backup.json";
  a.click();
  URL.revokeObjectURL(url);
};
$("#importFile").addEventListener("change", async (e) => {
  const file = e.target.files[0];
  if (!file) return;
  try{
    const text = await file.text();
    const obj = JSON.parse(text);
    if (!obj || typeof obj !== "object" || !("totalXP" in obj)) throw new Error("Invalid file");
    localStorage.setItem("success_hunter_v2", JSON.stringify(obj));
    state = obj;
    renderAll();
  }catch(err){
    alert("Import failed: " + err.message);
  } finally { e.target.value = ""; }
});

// ===== Fireworks + Applause =====
const fxCanvas = document.getElementById("fxCanvas");
const gg = document.querySelector(".gg");
const ggMsg = document.getElementById("ggMsg");
const ctx = fxCanvas.getContext("2d");
function resizeCanvas(){ fxCanvas.width = window.innerWidth; fxCanvas.height = window.innerHeight; }
window.addEventListener("resize", resizeCanvas); resizeCanvas();
let particles = [];
function celebrate(message){
  ggMsg.textContent = message;
  gg.classList.add("show");
  particles = [];
  for (let i=0;i<300;i++){
    particles.push({ x: fxCanvas.width/2, y: fxCanvas.height*0.6, vx: (Math.random()-0.5)*8, vy: -Math.random()*10 - 2, life: 60 + Math.random()*60, color: `hsl(${Math.floor(Math.random()*360)}, 100%, 60%)` });
  }
  fxCanvas.classList.add("show");
  playCelebration();
  animateFX();
  setTimeout(()=>{ fxCanvas.classList.remove("show"); gg.classList.remove("show"); }, 3000);
}
function animateFX(){
  ctx.clearRect(0,0,fxCanvas.width, fxCanvas.height);
  particles.forEach(p=>{ p.vy += 0.15; p.x += p.vx; p.y += p.vy; p.life -= 1; ctx.fillStyle = p.color; ctx.fillRect(p.x, p.y, 3, 3); });
  particles = particles.filter(p=>p.life>0 && p.y<fxCanvas.height+10);
  if (particles.length){ requestAnimationFrame(animateFX); }
}
let audioCtx;
function playCelebration(){
  try{
    if (!audioCtx) audioCtx = new (window.AudioContext||window.webkitAudioContext)();
    for (let i=0;i<6;i++){ setTimeout(()=> noiseBurst(0.12 + Math.random()*0.15, 500+Math.random()*800), i*180); }
    const now = audioCtx.currentTime + 0.2;
    for (let i=0;i<8;i++){ clap(now + i*0.18, 0.25); }
  }catch(e){}
}
function noiseBurst(duration, cutoffHz){
  const sr = audioCtx.sampleRate;
  const frameCount = sr * duration;
  const buffer = audioCtx.createBuffer(1, frameCount, sr);
  const data = buffer.getChannelData(0);
  for (let i=0; i<frameCount; i++){ data[i] = (Math.random()*2-1) * Math.pow(1 - i/frameCount, 1.8); }
  const src = audioCtx.createBufferSource(); src.buffer = buffer;
  const filter = audioCtx.createBiquadFilter(); filter.type="highpass"; filter.frequency.value = cutoffHz;
  const gain = audioCtx.createGain(); gain.gain.value = 0.35;
  src.connect(filter).connect(gain).connect(audioCtx.destination);
  src.start();
}
function clap(startTime, gainLevel){
  const osc = audioCtx.createOscillator();
  const gain = audioCtx.createGain();
  osc.type="square";
  osc.frequency.setValueAtTime(600, startTime);
  gain.gain.setValueAtTime(gainLevel, startTime);
  gain.gain.exponentialRampToValueAtTime(0.001, startTime+0.12);
  osc.connect(gain).connect(audioCtx.destination);
  osc.start(startTime);
  osc.stop(startTime+0.15);
}

// Init
document.addEventListener("DOMContentLoaded", ()=>{ $("#playerName").value = state.playerName; $("#langSelect").value = state.lang; renderAll(); });
</script>
</body>
</html>